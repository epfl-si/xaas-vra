layout:
  pages:
  - id: page_1
    sections:
    - id: section_cluster
      fields:
      - id: cluster
        display: valuePicker
        state:
          read-only: true
          visible: true
        submit: false
        signpostPosition: right-middle

    - id: section_namespace
      fields:
      - id: namespace
        display: radio
        state:
          read-only: false
          visible: true
        signpostPosition: right-middle

    - id: section_nbLoadBalacers
      fields:
      - id: nbLoadBalacers
        display: decimalField
        state:
          read-only: true
          visible: true
        signpostPosition: right-middle

    - id: section_status
      fields:
      - id: status
        display: textField
        state:
          read-only: true
          visible: true
        signpostPosition: right-middle

    - id: section_information
      fields:
      - id: information
        display: textArea
        signpostPosition: right-middle
        state:
          visible: true
          read-only: true

    state: {}
    title: General
options:
  externalValidations: []
schema:
  cluster:
    constraints: {}
    label: Cluster
    type:
      dataType: reference
      isMultiple: false
      referenceType: DynamicTypes:XaasK8s.Cluster
  nbLoadBalacers:
    constraints: {}
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsNumber
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`namespaces`'
      - $type:
          dataType: string
          isMultiple: false
        dtId: _resource.object.name
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: _resource.object.targetTenant
      - $type:
          dataType: string
          isMultiple: false
        dtName: _resource.object.namespace
      - $type:
          dataType: string
          isMultiple: false
        sizeConversion: '``'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: namespace
      - $type:
          dataType: string
          isMultiple: false
        filterField: '`name`'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '`resourceQuota.spec.hard.services.loadbalancers`'
      type: scriptAction
    label: '# LoadBalancers'
    step: 1
    type:
      dataType: decimal
  namespace:
    constraints:
      required: true
    label: Namespace
    type:
      dataType: string
    valueList:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsStringArray
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`namespacesNames`'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: '``'
      - $type:
          dataType: string
          isMultiple: false
        dtId: _resource.object.name
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: _resource.object.targetTenant
      - $type:
          dataType: string
          isMultiple: false
        dtName: _resource.object.namespace
      - $type:
          dataType: string
          isMultiple: false
        filterField: '``'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '``'
      type: scriptAction
  status:
    constraints:
      pattern:
        message: Cannot add LoadBalancer.
        value: ^Ok$
      required: true
    default:
      id: ch.epfl.xaas.k8s/cadAddDelNSLB
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        namespace: namespace
      - $type:
          dataType: string
          isMultiple: false
        clusterName: _resource.object.name
      - $type:
          dataType: string
          isMultiple: false
        operation: '`addNSLB`'
      type: scriptAction
    label: Status
    placeholder: ''
    type:
      dataType: string

  information:
    label: Information
    type:
      dataType: string
    default: |-
      Caution: You can have at most ONE LoadBalancer in namespace
    placeholder: ''
    constraints: { }

