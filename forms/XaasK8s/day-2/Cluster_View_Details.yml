layout:
  pages:
    - id: page_general
      title: General
      sections:
        - id: section_DEBUG_G
          fields:
            - id: DEBUG_G
              display: checkbox
              state:
                visible: false
                read-only: false
              signpostPosition: right-middle
        - id: section_cluster
          fields:
            - id: object
              display: valuePicker
              state:
                visible: true
                read-only: true
              submit: false
              signpostPosition: right-middle
        - id: section_status
          fields:
            - id: status
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_caution
          fields:
            - id: textField_caution
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
      state: {}
    - id: page_deployment_properties
      title: Deployment
      sections:
        - id: section_DEBUG_D
          fields:
            - id: DEBUG_D
              display: checkbox
              state:
                visible: false
                read-only: false
              signpostPosition: right-middle
        - id: section_cluster_D
          fields:
            - id: cluster_D
              display: valuePicker
              state:
                visible: true
                read-only: true
              submit: false
              signpostPosition: right-middle
        - id: section_projectName
          fields:
          - id: projectName
            display: textField
            state:
              visible: true
              read-only: true
            signpostPosition: right-middle
          - id: projectId
            display: textField
            state:
              visible: true
              read-only: true
            signpostPosition: right-middle
        - id: section_deploymentId
          fields:
            - id: textField_deploymentId
              display: textField
              state:
                visible:
                  - value: true
                    equals:
                      DEBUG_D: true
                read-only: true
              signpostPosition: right-middle
        - id: section_deploymentName
          fields:
            - id: deploymentName
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_description
          fields:
            - id: description
              display: textArea
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_requestor
          fields:
            - id: requestor
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_env
          fields:
            - id: env
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_notificationMail
          fields:
            - id: notificationMail
              display: textArea
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_funding
          fields:
            - id: funding
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_fnsPrjName
          fields:
            - id: fnsPrjName
              display: textField
              state:
                visible:
                  - value: true
                    equals:
                      funding: FNS
                read-only: true
              signpostPosition: right-middle
            - id: fnsPrjNo
              display: textField
              state:
                visible:
                  - value: true
                    equals:
                      funding: FNS
                read-only: true
              signpostPosition: right-middle
      state: {}
    - id: page_cluster_properties
      sections:
        - id: section_DEBUG_C
          fields:
            - id: DEBUG_C
              display: checkbox
              state:
                visible: false
                read-only: false
              signpostPosition: right-middle
        - id: section_cluster_C
          fields:
            - id: cluster_C
              display: valuePicker
              state:
                visible: true
                read-only: true
              submit: false
              signpostPosition: right-middle
        - id: section_clusterId
          fields:
            - id: clusterId
              display: textField
              state:
                visible:
                  - value: true
                    equals:
                      DEBUG_C: true
                read-only: true
              signpostPosition: right-middle
        - id: section_plan
          fields:
            - id: plan
              display: textField
              state:
                visible: true
                read-only: true
              signpostPosition: right-middle
        - id: section_clusterParameters
          fields:
            - id: datagrid_clusterParameters
              display: datagrid
              state:
                visible: true
                read-only: true
                hidden-fields: []
              signpostPosition: right-middle
      title: Cluster
      state:
        visible:
          - value: true
            equals:
              status: Ok
    - id: page_namespace_properties
      sections:
        - id: section_DEBUG_N
          fields:
            - id: DEBUG_N
              display: checkbox
              state:
                visible: false
                read-only: false
              signpostPosition: right-middle
        - id: section_cluster_N
          fields:
            - id: cluster_N
              display: valuePicker
              state:
                visible: true
                read-only: true
              submit: false
              signpostPosition: right-middle
        - id: section_radio_namespace
          fields:
            - id: radio_namespace
              display: radio
              state:
                visible: true
                read-only: false
              signpostPosition: right-middle
        - id: section_namespaceParameters
          fields:
            - id: datagrid_namespaceParameters
              display: datagrid
              state:
                visible: true
                read-only: true
                hidden-fields: []
              signpostPosition: right-middle
      title: Namespaces
      state:
        visible:
          - value: true
            equals:
              status: Ok
schema:
  # details - general (loading resource)
  DEBUG_G:
    label: DEBUG (G)
    type:
      dataType: boolean
    default: false
    constraints: {}
  object:
    label: Cluster
    type:
      dataType: reference
      referenceType: 'DynamicTypes:XaasK8s.Cluster'
      isMultiple: false
    constraints: {}
  status:
    label: Status
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.k8s/isClusterBackendMsg
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          clusterName: _resource.object.name
    constraints: {}
  textField_caution:
    label: Caution
    type:
      dataType: string
    default: Nothing to submit here
    placeholder: ''
    constraints:
      pattern:
        value: ^$
        message: Nothing to submit here

  # deployment - general
  DEBUG_D:
    label: DEBUG (D)
    type:
      dataType: boolean
    default: false
    constraints: {}
  cluster_D:
    label: Cluster
    type:
      dataType: reference
      referenceType: 'DynamicTypes:XaasK8s.Cluster'
      isMultiple: false
    constraints: {}
  textField_deploymentId:
    label: deploymentId
    type:
      dataType: string
    default:
      bind: _deploymentId
    placeholder: ''
    constraints: {}
  deploymentName:
    label: Deployment Name
    type:
      dataType: string
      isMultiple: false
    default:
      id: ch.epfl.xaas.misc/getDeploymentData
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          field: '`name`'
        - $type:
            dataType: string
            isMultiple: false
          deploymentId: textField_deploymentId
    constraints: {}
  env:
    label: Environment
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.env
    constraints: {}
  description:
    label: Description
    type:
      dataType: string
      isMultiple: false
    default:
      id: ch.epfl.xaas.misc/getDeploymentData
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          field: '`description`'
        - $type:
            dataType: string
            isMultiple: false
          deploymentId: textField_deploymentId
    constraints:
      max-value: 256
  notificationMail:
    label: Notification Mail
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.notificationMail
    constraints: {}
  projectId:
    label: Project Id
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.projectId
    constraints: {}
  projectName:
    label: Project Name
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.projectName
    constraints: {}
  requestor:
    label: Requestor
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.requestor
    constraints: {}

  # deployment - funding
  fnsPrjName:
    label: Project Name
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.fnsPrjName
  fnsPrjNo:
    label: Project Number
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.fnsPrjNo
  funding:
    label: Funding
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.k8s/getFunding
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          fnsPrjName: _resource.object.fnsPrjName
    valueList:
      - label: EPFL
        value: epfl
      - label: FNS
        value: fns
    placeholder: ''
    constraints: {}

  # cluster information
  DEBUG_C:
    label: DEBUG (C)
    default: false
    type:
      dataType: boolean
    constraints: {}
  cluster_C:
    label: Cluster
    type:
      dataType: reference
      referenceType: 'DynamicTypes:XaasK8s.Cluster'
      isMultiple: false
    constraints: {}
  clusterId:
    label: Cluster Id
    type:
      dataType: string
      isMultiple: false
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsString
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          jsonPath: '`cluster.uuid`'
        - $type:
            dataType: string
            isMultiple: false
          filterValue: '``'
        - dtId: _resource.object.name
          $type:
            dataType: string
            isMultiple: false
        - $type:
            dataType: string
            isMultiple: false
          targetTenant: _resource.object.targetTenant
        - $type:
            dataType: string
            isMultiple: false
          dtName: _resource.object.namespace
        - $type:
            dataType: string
            isMultiple: false
          filterField: '``'
        - $type:
            dataType: string
            isMultiple: false
          jsonSubPath: '``'
    constraints: {}
  plan:
    label: Plan
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsString
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          jsonPath: '`cluster.plan_name`'
        - $type:
            dataType: string
            isMultiple: false
          filterValue: '``'
        - dtId: _resource.object.name
          $type:
            dataType: string
            isMultiple: false
        - $type:
            dataType: string
            isMultiple: false
          targetTenant: _resource.object.targetTenant
        - $type:
            dataType: string
            isMultiple: false
          dtName: _resource.object.namespace
        - $type:
            dataType: string
            isMultiple: false
          filterField: '``'
        - $type:
            dataType: string
            isMultiple: false
          jsonSubPath: '``'
    placeholder: ''
    constraints: {}
  datagrid_clusterParameters:
    label: Parameters
    type:
      dataType: complex
      fields:
        - label: Key
          type:
            dataType: string
          constraints: {}
          id: key
        - label: Value
          type:
            dataType: string
          constraints: {}
          id: value
      isMultiple: true
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsProperties
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          jsonPath: '`cluster.parameters`'
        - $type:
            dataType: string
            isMultiple: false
          filterValue: '``'
        - dtId: _resource.object.name
          $type:
            dataType: string
            isMultiple: false
        - $type:
            dataType: string
            isMultiple: false
          targetTenant: _resource.object.targetTenant
        - $type:
            dataType: string
            isMultiple: false
          dtName: _resource.object.namespace
        - $type:
            dataType: string
            isMultiple: false
          filterField: '``'
        - $type:
            dataType: string
            isMultiple: false
          jsonSubPath: '``'
    placeholder: ''
    constraints: {}

  # namespace information
  DEBUG_N:
    label: DEBUG (N)
    type:
      dataType: boolean
    default: false
    constraints: {}
  cluster_N:
    label: Cluster
    type:
      dataType: reference
      referenceType: 'DynamicTypes:XaasK8s.Cluster'
      isMultiple: false
    constraints: {}
  datagrid_namespaceParameters:
    label: Parameters
    type:
      dataType: complex
      fields:
        - label: Key
          type:
            dataType: string
          constraints: {}
          id: key
        - label: Value (empty = 0)
          type:
            dataType: integer
          constraints: {}
          id: value
      isMultiple: true
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsProperties
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          jsonPath: '`namespaces`'
        - dtId: _resource.object.name
          $type:
            dataType: string
            isMultiple: false
        - $type:
            dataType: string
            isMultiple: false
          targetTenant: _resource.object.targetTenant
        - $type:
            dataType: string
            isMultiple: false
          dtName: _resource.object.namespace
        - $type:
            dataType: string
            isMultiple: false
          filterValue: radio_namespace
        - $type:
            dataType: string
            isMultiple: false
          filterField: '`name`'
        - $type:
            dataType: string
            isMultiple: false
          jsonSubPath: '`resourceQuota.spec.hard`'
    placeholder: Namespace parameters will appear in this area
    constraints: {}
  radio_namespace:
    label: Namespace
    type:
      dataType: string
    valueList:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsStringArray
      type: scriptAction
      parameters:
        - $type:
            dataType: string
            isMultiple: false
          jsonPath: '`namespacesNames`'
        - $type:
            dataType: string
            isMultiple: false
          filterValue: '``'
        - $type:
            dataType: string
            isMultiple: false
          dtId: _resource.object.name
        - $type:
            dataType: string
            isMultiple: false
          targetTenant: _resource.object.targetTenant
        - $type:
            dataType: string
            isMultiple: false
          dtName: _resource.object.namespace
        - $type:
            dataType: string
            isMultiple: false
          filterField: '``'
        - $type:
            dataType: string
            isMultiple: false
          jsonSubPath: '``'
    constraints: {}
options:
  externalValidations: []
