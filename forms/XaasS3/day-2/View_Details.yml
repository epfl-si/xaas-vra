layout:
  pages:
  - id: page_deployment_properties
    title: Deployment
    sections:
    - id: section_DEBUG_D
      fields:
      - id: DEBUG_D
        display: checkbox
        state:
          visible: false
          read-only: false
        signpostPosition: right-middle
    - id: section_bucket_D
      fields:
        - id: bucket_D
          display: textField
          state:
            visible: true
            read-only: true
          submit: false
          signpostPosition: right-middle
    - id: section_projectName
      fields:
      - id: projectName
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
      - id: projectId
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_deploymentName_D
      fields:
      - id: deploymentName_D
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_description
      fields:
      - id: description
        display: textArea
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_requestor
      fields:
      - id: requestor
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_env
      fields:
      - id: env
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_notificationMail
      fields:
      - id: notificationMail
        display: textArea
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_funding
      fields:
      - id: funding
        display: textField
        state:
          visible:
            type: scriptAction
            id: ch.epfl.xaas.s3/hasFunding
            parameters: []
          read-only: true
        signpostPosition: right-middle
    - id: section_fnsPrjName
      fields:
      - id: fnsPrjName
        display: textField
        state:
          visible:
          - value: true
            equals:
              funding: FNS
          read-only: true
        signpostPosition: right-middle
      - id: fnsPrjNo
        display: textField
        state:
          visible:
          - value: true
            equals:
              funding: FNS
          read-only: true
        signpostPosition: right-middle
    - id: section_status
      fields:
      - id: status
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_caution
      fields:
      - id: textField_caution
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    state: {}
  - id: page_bucket_properties
    title: Bucket
    sections:
    - id: section_DEBUG_B
      fields:
      - id: DEBUG_B
        display: checkbox
        state:
          visible: false
          read-only: false
        signpostPosition: right-middle
    - id: section_bucket_B
      fields:
        - id: bucket_B
          display: textField
          state:
            visible: true
            read-only: true
          signpostPosition: right-middle
    - id: section_bucketUsageMB
      fields:
      - id: bucketUsageMB
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_nbObjects
      fields:
      - id: nbObjects
        display: integerField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_empty
      fields:
      - id: empty
        display: checkbox
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_versioning
      fields:
      - id: versioning
        display: textField
        state:
          visible: true
          read-only: true
        signpostPosition: right-middle
    - id: section_linkedTo
      fields:
      - id: linkedTo
        display: array
        state:
          visible:
            id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsBoolean
            type: scriptAction
            parameters:
            - $type:
                dataType: string
                isMultiple: false
              jsonPath: '`hasLikendBuckets`'
            - $type:
                dataType: string
                isMultiple: false
              filterValue: '``'
            - dtId: _resource.object.id
              $type:
                dataType: string
                isMultiple: false
            - $type:
                dataType: string
                isMultiple: false
              targetTenant: '``'
            - $type:
                dataType: string
                isMultiple: false
              dtName: '`XaasS3`'
            - $type:
                dataType: string
                isMultiple: false
              filterField: '``'
            - $type:
                dataType: string
                isMultiple: false
              jsonSubPath: '``'
          read-only: true
        signpostPosition: right-middle
    state:
      visible:
      - value: true
        equals:
          status: Ok

schema:
  # details - general (loading resource)
  bucket:
    label: Volume
    type:
      dataType: reference
      referenceType: DynamicTypes:XaasS3.Bucket
    constraints:
      required: false
  status:
    label: Status
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.s3/isBucketInBackendMsg
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        bucketName: _resource.object.name
    constraints:
      required: true
  textField_caution:
    label: Caution
    type:
      dataType: string
    default: Nothing to submit here
    placeholder: ''
    constraints:
      pattern:
        value: ^$
        message: Nothing to submit here

  # deployment - general
  DEBUG_D:
    label: DEBUG (d)
    type:
      dataType: boolean
    default: false
    constraints: { }
  bucket_D:
    label: Bucket name
    type:
      dataType: string
    default:
      bind: _resource.object.name
    placeholder: ''
    constraints: { }
  deploymentName_D:
    label: Deployment
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.deploymentName
    constraints: { }
  description:
    label: Description
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.deploymentDescription
    constraints:
      max-value: 256
  projectId:
    label: Project Id
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.projectId
    constraints: {}
  projectName:
    label: Project Name
    type:
      dataType: string
    default:
      bind: _resource.object.projectName
    placeholder: ''
    constraints: {}
  env:
    label: Environment
    type:
      dataType: string
    default:
      bind: _resource.object.env
    placeholder: ''
    constraints: {}
  notificationMail:
    label: Notification Mail
    type:
      dataType: string
    default:
      bind: _resource.object.notificationMail
    placeholder: ''
    constraints: {}
  requestor:
    label: Requestor
    type:
      dataType: string
    default:
      bind: _resource.object.requestor
    placeholder: ''
    constraints: {}

  # deployment - funding
  fnsPrjName:
    label: Project Name
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.fnsPrjName
  fnsPrjNo:
    label: Project Number
    type:
      dataType: string
      isMultiple: false
    default:
      bind: _resource.object.fnsPrjNo
  funding:
    label: Funding
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.k8s/getFunding
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        fnsPrjName: _resource.object.fnsPrjName
    valueList:
    - label: EPFL
      value: epfl
    - label: FNS
      value: fns
    placeholder: ''
    constraints: {}

  # bucket-specific part
  DEBUG_B:
    # debug bucket
    label: DEBUG (b)
    type:
      dataType: boolean
    default: true
    constraints: {}
  bucket_B:
    label: Bucket name
    type:
      dataType: string
    default:
      bind: _resource.object.name
    placeholder: ''
    constraints: { }
  bucketUsageMB:
    label: Bucket usage (MB)
    type:
      dataType: decimal
    step: 1
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsNumber
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`usage.storageUtilizedMB`'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: '``'
      - dtId: _resource.object.name
        $type:
          dataType: string
          isMultiple: false
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: '`test`'
      - $type:
          dataType: string
          isMultiple: false
        dtName: '`XaasS3`'
      - $type:
          dataType: string
          isMultiple: false
        filterField: '``'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '``'
    constraints: {}
  nbObjects:
    label: Number of objects
    type:
      dataType: integer
    step: 1
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsNumber
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`usage.numberOfObjects`'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: '``'
      - dtId: _resource.object.name
        $type:
          dataType: string
          isMultiple: false
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: '``'
      - $type:
          dataType: string
          isMultiple: false
        dtName: '`XaasS3`'
      - $type:
          dataType: string
          isMultiple: false
        filterField: '``'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '``'
    constraints: {}
  empty:
    label: Empty?
    type:
      dataType: boolean
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsBoolean
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`empty`'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: '``'
      - dtId: _resource.object.name
        $type:
          dataType: string
          isMultiple: false
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: '``'
      - $type:
          dataType: string
          isMultiple: false
        dtName: '`XaasS3`'
      - $type:
          dataType: string
          isMultiple: false
        filterField: '``'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '``'
    constraints: {}
  versioning:
    label: Versioning
    type:
      dataType: string
    default:
      id: ch.epfl.xaas.customform.cache/getCacheInfoFldAsString
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        jsonPath: '`versioning.status`'
      - $type:
          dataType: string
          isMultiple: false
        filterValue: '``'
      - dtId: _resource.object.name
        $type:
          dataType: string
          isMultiple: false
      - $type:
          dataType: string
          isMultiple: false
        targetTenant: '``'
      - $type:
          dataType: string
          isMultiple: false
        dtName: '`XaasS3`'
      - $type:
          dataType: string
          isMultiple: false
        filterField: '``'
      - $type:
          dataType: string
          isMultiple: false
        jsonSubPath: '``'
    placeholder: ''
    constraints: {}
  linkedTo:
    label: Linked to
    type:
      dataType: string
      isMultiple: true
    default:
      id: ch.epfl.xaas.s3/getLinkedBuckets_withEmails
      type: scriptAction
      parameters:
      - $type:
          dataType: string
          isMultiple: false
        bucketName: _resource.object.name
    constraints: {}
options:
  externalValidations: []
